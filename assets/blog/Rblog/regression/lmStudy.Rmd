---
title: "lm() function and regression indepth study"
author: "Jizong Liang"
date: "September 19, 2015"
output: html_document
---

This study is based on this primary source [Understanding lm() output](http://www.montana.edu/screel/Webpages/conservation%20biology/Interpreting%20Regression%20Coefficients.html#/)

```{r,results='asis',echo=TRUE}
## pack size as number of adults
packsize <- c(9,8,10,6,13,10,6,15,18,17)
## home range size in km2
homerange <- c(25,20,28,36,22,46,52,41,59,59)
```

The hypothesis of this study is that home range size depends on pack size.

```{r,echo=TRUE,results='asis',fig.height=5,fig.width=5}
plot(y = homerange, x = packsize, xlab = "Pack Size (adults)", ylab = "Home Range (km2)", 
     col = 'red', pch = 19, cex = 2.5, cex.axis = 1.3, cex.lab = 1.3)
```

```{r,echo=TRUE,results='asis'}
mod1 <- lm(homerange ~ packsize)
mod1
summary(mod1)
```



The following is to manually calcuate the results got from mod1 and it is adapted from the source [Um blog sobre nada](https://dmenin.wordpress.com/2014/11/12/t-test-for-regression-coefficients/)


```{r,echo=TRUE,results='asis'}
library(ggplot2)
## preparing the data
x <- c(9,8,10,6,13,10,6,15,18,17)
#home range size in km2
y <- c(25,20,28,36,22,46,52,41,59,59)
n= length(y)

## Slope and intersect:
beta1 <- cor(y, x) * sd(y) / sd(x)
beta0 <- mean(y) - beta1*mean(x)
```

#### 1 Calculate the error:
```{r,echo=TRUE,results='asis'}
e <- y - beta0 - beta1 * x #y – (beta1*x + beta0)
```
#### caculate Sigma
```{r,echo=TRUE,results='asis'}
sigma <- sqrt(sum(e^2) / (n-2))
sigma
```

#### Calculate the sum of the squared Xs:
```{r,echo=TRUE,results='asis'}
ssx <- sum((x - mean(x))^2) 
ssx
```

#### Calculate the standard error for Beta0 and Beta1 
```{r,echo=TRUE,results='asis'}
seBeta0 <- (1 / n + mean(x) ^ 2 / ssx) ^ .5 * sigma 
seBeta1 <- sigma / sqrt(ssx)
seBeta1;seBeta0
```

#### T distribution for hypothesis testing: 
```{r,echo=TRUE,results='asis'}
tBeta0 <- beta0 / seBeta0
tBeta1 <- beta1 / seBeta1 
tBeta0;tBeta1
```

#### P values (shouldn’t be bigger than 1): 
```{r,echo=TRUE,results='asis'}
pBeta0 <- 2 * pt(abs(tBeta0), df = n - 2, lower.tail = FALSE) 
pBeta1 <- 2 * pt(abs(tBeta1), df = n - 2, lower.tail = FALSE) 
```



#### plotting 95% CI with slope
```{r,echo=TRUE,results='asis',fig.height=5,fig.width=5}
data1 <- data.frame(packsize,homerange)
g <- ggplot(data1, aes(x = packsize, y = homerange))
g <- g + geom_point(colour = "red", size = 6)
g <- g + geom_smooth(method = lm)
g <- g + ylab("Home Range (km2)")
g <- g + xlab("Pack Size (adults)")
g
```
 
In this case, the 95% CI (grey) for the regression line (blue) includes slopes of zero (horizontal)
so the slope does not differ from zero with ≥ 95% confidence.
In other words, we can't have 95% confidence that home range size is related to pack size, although
there is reasonable evidence that it is.

#### plotting 90%CI with slop
```{r,echo=TRUE,results='asis',fig.height=5,fig.width=5}
data1 <- data.frame(packsize,homerange)
g <- ggplot(data1, aes(x = packsize, y = homerange))
g <- g + geom_point(colour = "red", size = 6)
g <- g + geom_smooth(method = lm, level = 0.9)
g <- g + ylab("Home Range (km2)")
g <- g + xlab("Pack Size (adults)")
g
```

#### Multiple Regression

 check out [effect size](http://nursing.ucla.edu/workfiles/research/Effect%20Size%204-9-2012.pdf)